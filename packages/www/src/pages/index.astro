---
import Layout from '@layouts/base.astro'
import Countdown from '@components/countdown.astro'
import Cursor from '@components/cursor.astro'
import Line from '@components/line.astro'
---

<Layout>
  <Line number={1}>
    <h1 set:html="//something is brewing, check back in..." />
  </Line>
  <Line number={2}>
    <div class="flex items-center gap-1.5">
      <Countdown date="2024-04-18" class="text-white" />
    </div>
  </Line>
  <Line number={3}>
    <span set:html="//enter your email address" />
  </Line>
  <Line id="email-line" number={4} class="group">
    <div class="flex items-center overflow-x-scroll no-scrollbar">
      <span
        autofocus
        contenteditable
        id="email-input"
        class:list={{
          'bg-transparent text-white leading-10 flex gap-2 flex-wrap': true,
          'focus:outline-none whitespace-nowrap caret-transparent': true,
        }}
        role="textbox"
      >
      </span>
    </div>
    <Cursor class="self-center shrink-0 hidden group-has-[:focus]:block" />
  </Line>
</Layout>
<script is:inline>
  const emailInput = document.getElementById('email-input')
  const emailLine = document.getElementById('email-line')
  emailLine.onclick = () => emailInput?.focus()

  emailInput.addEventListener('keypress', (evt) => {
    if (evt.key === 'Enter') {
      evt.preventDefault()

      emailLine.dataset.state = 'success'
      emailInput.contentEditable = false

      emailInput.classList.remove('whitespace-nowrap')
      emailInput.classList.add('whitespace-pre-wrap')

      emailInput.innerHTML =
        emailInput.innerText +
        " <img src='/icons/check.svg' class='w-4 h-4 self-center'> <span class='text-slate-10 whitespace-nowrap'>//signed up</span>"
    }
  })
</script>
